# 专注时长测算App - 执行任务计划

## 项目总览

**项目名称**: 专注时长测算（iOS版）
**开发周期**: 10个工作日（2周）
**团队规模**: 1-2人
**技术栈**: Swift + SwiftUI + iOS原生API

## 开发阶段划分

### 📋 第一阶段：基础架构（第1-2天）

#### 1.1 项目初始化
- [ ] **创建Xcode项目**（2小时）
  - 项目名称：FocusTracker
  - 最低iOS版本：15.0
  - SwiftUI生命周期
  - 启用所需权限

- [ ] **项目结构搭建**（4小时）
  ```
  FocusTracker/
  ├── Models/
  │   ├── FocusSession.swift
  │   ├── DailyFocus.swift
  │   └── DataQuality.swift
  ├── Services/
  │   ├── HealthKitManager.swift
  │   ├── MotionManager.swift
  │   ├── FocusDetectionEngine.swift
  │   ├── LocalStorage.swift
  │   └── NotificationManager.swift
  ├── Views/
  │   ├── MainView.swift
  │   ├── WidgetViews/
  │   └── SettingsView.swift
  └── Widgets/
      ├── FocusWidget.swift
      └── FocusWidgetBundle.swift
  ```

#### 1.2 权限系统实现
- [ ] **隐私权限申请**（4小时）
  - HealthKit读取权限（正念时间）
  - CoreMotion权限（设备运动）
  - 通知权限（推送提醒）
  - 小组件权限

- [ ] **权限检测UI**（2小时）
  - 首次启动权限引导页
  - 权限被拒绝时的友好提示
  - 设置跳转链接

### 📊 第二阶段：数据收集模块（第3-4天）

#### 2.1 HealthKit集成
- [ ] **HealthKitManager实现**（6小时）
  ```swift
  class HealthKitManager {
      func requestAuthorization() async throws
      func getMindfulMinutes(_ date: Date) -> TimeInterval
      func saveMindfulSession(_ duration: TimeInterval, _ date: Date)
  }
  ```

- [ ] **健康数据测试**（2小时）
  - 模拟健康数据
  - 边界情况测试（无数据/权限拒绝）

#### 2.2 CoreMotion集成
- [ ] **MotionManager实现**（6小时）
  ```swift
  class MotionManager {
      func requestAuthorization() async throws
      func getDeviceStillDuration(_ date: Date) -> TimeInterval
      func startMonitoring()
      func stopMonitoring()
  }
  ```

- [ ] **运动数据校准**（2小时）
  - 静止状态判定阈值调优
  - 不同设备型号测试

#### 2.3 通知监听系统
- [ ] **NotificationTracker实现**（4小时）
  - 通知频率统计
  - 打断时间估算算法
  - 系统通知权限处理

### 🧮 第三阶段：专注检测算法（第5-6天）

#### 3.1 核心算法开发
- [ ] **FocusDetectionEngine实现**（8小时）
  - 多源数据融合算法
  - 专注时间计算公式
  - 数据质量评估系统

- [ ] **算法调优**（4小时）
  - 权重参数优化
  - 边界情况处理
  - 准确性测试（目标85%+）

#### 3.2 数据存储系统
- [ ] **LocalStorage实现**（4小时）
  - JSON文件存储
  - 数据压缩和加密
  - iCloud同步支持

- [ ] **数据备份方案**（2小时）
  - CSV导出功能
  - 数据重置选项

### 🎨 第四阶段：UI/UX设计（第7-8天）

#### 4.1 主界面设计
- [ ] **极简主界面**（6小时）
  - 巨型专注时间显示
  - 渐变色彩系统
  - 微交互动画

- [ ] **图表组件**（4小时）
  - 今日时间轴视图
  - 本周趋势柱状图
  - 月度圆环图

#### 4.2 小组件开发
- [ ] **WidgetKit实现**（6小时）
  - 小号、中号小组件
  - 数据刷新机制
  - 深色模式支持

- [ ] **小组件UI优化**（2小时）
  - 字体和颜色调优
  - 边缘情况处理

### 📱 第五阶段：推送通知系统（第8-9天）

#### 5.1 推送管理
- [ ] **NotificationManager实现**（4小时）
  - 每日总结推送
  - 实时专注提醒
  - 用户自定义时间

- [ ] **推送内容生成**（2小时）
  - 动态文案生成
  - 数据洞察展示
  - 本地化支持

#### 5.2 用户设置
- [ ] **设置页面**（4小时）
  - 推送开关
  - 时间偏好设置
  - 数据导出功能

### 🔧 第六阶段：测试与优化（第9-10天）

#### 6.1 功能测试
- [ ] **单元测试**（4小时）
  - 算法准确性测试
  - 边界情况测试
  - 异常处理测试

- [ ] **集成测试**（4小时）
  - 端到端流程测试
  - 不同iOS版本兼容性
  - 设备适配测试

#### 6.2 性能优化
- [ ] **电池优化**（2小时）
  - 后台任务频率调优
  - 传感器使用优化
  - 内存泄漏检查

- [ ] **启动优化**（2小时）
  - 冷启动时间优化
  - 数据加载优化

## 每日详细任务清单

### 第1天：项目启动
**上午（4小时）**
- [ ] 09:00-09:30 Xcode项目创建和配置
- [ ] 09:30-11:00 项目结构搭建
- [ ] 11:00-12:00 基础权限系统框架

**下午（4小时）**
- [ ] 14:00-16:00 权限申请UI开发
- [ ] 16:00-18:00 基础数据模型创建

### 第2天：权限系统完善
**上午（4小时）**
- [ ] 09:00-11:00 HealthKit权限集成
- [ ] 11:00-12:00 CoreMotion权限集成

**下午（4小时）**
- [ ] 14:00-15:00 通知权限集成
- [ ] 15:00-18:00 权限状态管理

### 第3天：健康数据集成
**上午（4小时）**
- [ ] 09:00-11:00 HealthKitManager开发
- [ ] 11:00-12:00 正念数据读取

**下午（4小时）**
- [ ] 14:00-16:00 健康数据测试
- [ ] 16:00-18:00 异常处理完善

### 第4天：运动数据集成
**上午（4小时）**
- [ ] 09:00-11:00 MotionManager开发
- [ ] 11:00-12:00 静止状态检测

**下午（4小时）**
- [ ] 14:00-16:00 运动数据校准
- [ ] 16:00-18:00 设备兼容性测试

### 第5天：核心算法
**上午（4小时）**
- [ ] 09:00-11:00 算法框架实现
- [ ] 11:00-12:00 多源数据融合

**下午（4小时）**
- [ ] 14:00-16:00 权重参数调优
- [ ] 16:00-18:00 算法测试

### 第6天：数据存储
**上午（4小时）**
- [ ] 09:00-11:00 本地存储实现
- [ ] 11:00-12:00 数据模型完善

**下午（4小时）**
- [ ] 14:00-16:00 数据导入导出
- [ ] 16:00-18:00 备份功能

### 第7天：UI设计
**上午（4小时）**
- [ ] 09:00-11:00 主界面布局
- [ ] 11:00-12:00 色彩系统设计

**下午（4小时）**
- [ ] 14:00-16:00 图表组件开发
- [ ] 16:00-18:00 动画效果实现

### 第8天：小组件开发
**上午（4小时）**
- [ ] 09:00-11:00 WidgetKit框架集成
- [ ] 11:00-12:00 小组件UI开发

**下午（4小时）**
- [ ] 14:00-16:00 数据刷新机制
- [ ] 16:00-18:00 小组件测试

### 第9天：推送系统
**上午（4小时）**
- [ ] 09:00-11:00 推送管理器开发
- [ ] 11:00-12:00 推送内容生成

**下午（4小时）**
- [ ] 14:00-16:00 设置页面开发
- [ ] 16:00-18:00 推送测试

### 第10天：测试发布
**上午（4小时）**
- [ ] 09:00-11:00 功能测试
- [ ] 11:00-12:00 性能测试

**下午（4小时）**
- [ ] 14:00-16:00 最终优化
- [ ] 16:00-18:00 准备App Store提交

## 开发里程碑

| 里程碑 | 完成时间 | 验收标准 |
|--------|----------|----------|
| 基础架构完成 | 第2天 | 所有权限申请成功 |
| 数据收集完成 | 第4天 | 健康+运动数据正常读取 |
| 算法开发完成 | 第6天 | 专注时间计算准确性>80% |
| UI开发完成 | 第8天 | 主界面和小组件可用 |
| 功能测试完成 | 第10天 | 无严重bug，性能达标 |

## 风险预案

### 技术风险
- **健康数据权限被拒**：提供手动输入备份方案
- **算法准确性不足**：增加用户校准功能
- **电池消耗过高**：优化后台任务频率

### 时间风险
- **单个模块延期**：预留2天缓冲时间
- **第三方API变更**：保持代码可扩展性

## 质量保证

### 测试清单
- [ ] 不同iOS版本兼容性测试（15.0-17.0）
- [ ] 不同设备测试（iPhone SE - iPhone 15 Pro Max）
- [ ] 电池消耗测试（目标<5%/天）
- [ ] 网络异常测试（完全离线可用）
- [ ] 权限拒绝场景测试

### 代码规范
- SwiftLint代码规范检查
- 强制使用Swift文档注释
- 单元测试覆盖率>80%
- 关键路径添加日志记录

## 发布准备

### App Store准备清单
- [ ] 应用图标设计（1024x1024）
- [ ] 应用截图（6.7英寸、6.1英寸、5.5英寸）
- [ ] 应用描述撰写
- [ ] 隐私政策页面
- [ ] 测试Flight内测（20人）

### 提交审核注意事项
- 明确说明健康数据使用目的
- 提供用户数据删除功能
- 遵守Apple设计规范
- 准备审核被拒的应对方案
